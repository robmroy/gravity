!function(t){var e={};function i(s){if(e[s])return e[s].exports;var h=e[s]={i:s,l:!1,exports:{}};return t[s].call(h.exports,h,h.exports,i),h.l=!0,h.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var h in t)i.d(s,h,function(e){return t[e]}.bind(null,h));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e){t.exports=function(t){function e(e){(t=(0|e)%2147483647)<=0&&(t+=2147483646)}function i(){return t=48271*t%2147483647}return e(t),{seed:e,nextInt:i,nextFloat:function(){return(i()-1)/2147483646}}}},function(t,e,i){"use strict";i.r(e);const s=function(t,e,i,s,h,a,l){let n=a-h,o=2*Math.ceil(.5*(n/.1-1))+1,r=n/o;t.strokeStyle=l;for(let a=0;a<o;a++)t.beginPath(),a%2==0&&(t.arc(e,i,s,h+a*r,h+(a+1)*r),t.stroke())},h=function(t){const e=t[0],i=t[1];return 0==e?i>0?Math.PI/2:-Math.PI/2:e>0?Math.atan(i/e):Math.PI+Math.atan(i/e)},a=function(t){return Math.sqrt(t[0]**2+t[1]**2)},l=function(t,e){let[i,s]=t,[h,a]=e;return(a-i)*(h-i)<=0||(a-s)*(h-s)<=0||(s-h)*(i-h)<=0||(s-a)*(i-a)<=0},n=()=>{let t=document.getElementById("game-canvas").getBoundingClientRect();return{x:t.x,y:t.y}};var o=class{constructor(t,e=0,i=0,s=[0,1],a=Math.PI/2,l=160,n="white"){this.game=t,this.x=e,this.y=i,this.normal=s,this.radius=l,this.color=n,this.draw=this.draw.bind(this),this.move=this.move.bind(this),this.launch=this.launch.bind(this),this.arrowVector=this.arrowVector.bind(this),this.updatePolar=this.updatePolar.bind(this),this.updateArrowTip=this.updateArrowTip.bind(this),this.updateLaunchVelocity=this.updateLaunchVelocity.bind(this),this.launchVx=0,this.launchVy=0,this.normalAngle=h(s),this.setVelocity=this.setVelocity.bind(this),this.arrowTip={x:null,y:null},this.arrowAngle=this.normalAngle,this.arrowLength=60,this.maxTheta=a,this.thetaRestrictionHelper=(1-Math.cos(a))**2+Math.sin(a)**2,this.setVelocityByArrowKeys=this.setVelocityByArrowKeys.bind(this)}move(){this.x+=this.vx,this.y+=this.vy}vpX(){return this.game.vp.displayPos(this).x}vpY(){return this.game.vp.displayPos(this).y}arrowVector(){const t=this.game.vp;return[this.arrowTip.x-(this.x-t.x1)*t.zoom,this.arrowTip.y-(this.y-t.y1)*t.zoom]}updatePolar(){this.arrowLength=a(this.arrowVector()),this.arrowAngle=h(this.arrowVector())}updateArrowTip(){let t=this.game.vp;this.arrowTip.x=this.x-t.x1+this.arrowLength*Math.cos(this.arrowAngle),this.arrowTip.y=this.y-t.y1+this.arrowLength*Math.sin(this.arrowAngle)}updateLaunchVelocity(){let t=this.game.vp;this.launchVx=this.arrowVector()[0]/(8*t.zoom),this.launchVy=this.arrowVector()[1]/(8*t.zoom)}draw(t,e){let i=e.zoom,h=(this.x-e.x1)*i,a=(this.y-e.y1)*i,l=this.radius*i;s(t,h,a,l,this.normalAngle-this.maxTheta,this.normalAngle+this.maxTheta,this.color);let n=this.game.currentPlanet;if(null===this.arrowTip.x&&(n.hideText=!1),null!==this.arrowTip.x){t.beginPath(),t.strokeStyle="white",t.setLineDash([5,5]),t.moveTo(h,a),t.lineTo(this.arrowTip.x,this.arrowTip.y),t.stroke(),this.drawArrowBits(t),t.beginPath();let e=.5*(h+this.arrowTip.x),s=.5*(a+this.arrowTip.y);t.fillStyle="purple",t.font="21px Arial",t.fillText(`Initial speed: ${(this.arrowLength/(8*i)).toFixed(2)}`,`${e}`,`${s}`),t.fill();let l=this.game.vp,o=this.game.ball;e>=n.textPos.x-l.x1-150&&s>=n.textPos.y-l.y1-28+o.radius&&s<=n.textPos.y-l.y1+8+o.radius?n.hideText=!0:n.hideText=!1}}drawArrowBits(t){let{x:e,y:i,arrowTip:s,game:a}=this,l=a.vp;e=(e-l.x1)*l.zoom,i=(i-l.y1)*l.zoom;const n=h([s.x-e,s.y-i]);t.setLineDash([]),t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(s.x+12*Math.cos(n+3*Math.PI/4),s.y+12*Math.sin(n+3*Math.PI/4)),t.moveTo(s.x,s.y),t.lineTo(s.x+12*Math.cos(n-3*Math.PI/4),s.y+12*Math.sin(n-3*Math.PI/4)),t.stroke()}launch(){return null!==this.arrowTip.x&&(this.game.ball.stopped=!1,this.game.ball.vx=this.launchVx,this.game.ball.vy=this.launchVy,!0)}setVelocity(t){if(!this.cursor&&!t)return;const e=this.game.vp;t&&(this.cursor={x:t.clientX-n().x,y:t.clientY-n().y});const i=this.cursor,s=i.x-(this.x-e.x1)*e.zoom,h=i.y-(this.y-e.y1)*e.zoom,a=Math.sqrt(s**2+h**2);s**2+h**2<=(this.radius*e.zoom)**2&&(this.normal[0]-s/a)**2+(this.normal[1]-h/a)**2<=this.thetaRestrictionHelper?(this.arrowTip.x=i.x,this.arrowTip.y=i.y,this.updateLaunchVelocity(),this.updatePolar()):this.arrowTip.x=null}setVelocityByArrowKeys(t,e){if(![13,32,37,38,39,40].includes(t.keyCode))return;const i=this.arrowLength;40===t.keyCode&&(this.arrowLength=Math.max(i-.4,0)),38===t.keyCode&&(this.arrowLength=Math.min(i+.4,this.radius)),37===t.keyCode&&(this.arrowAngle-=.004),39===t.keyCode&&(this.arrowAngle+=.004),[32,13].includes(t.keyCode)&&this.launch()&&e(),this.updateArrowTip(),this.updateLaunchVelocity()}};var r=class{constructor(t,e=0,i=0,s=5,h="white",a=0,l=0){this.game=t,this.x=e,this.y=i,this.radius=s,this.color=h,this.draw=this.draw.bind(this),this.move=this.move.bind(this),this.vx=a,this.vy=l,this.ax=0,this.ay=0,this.stopped=!0,this.prevx=e,this.prevy=i,this.drawX=e,this.drawY=i,this.interpolateX=e,this.interpolateY=i,this.prevInterpolateX=e,this.prevInterpolateY=i}vpX(){return this.game.vp.displayPos(this).x}vpY(){return this.game.vp.displayPos(this).y}setAuxPositions(){const t=this.game.playSpeed,e=this.game.vp;if(this.prevInterpolateX=this.interpolateX,this.prevInterpolateY=this.interpolateY,t.fractional&&t.num>1){const e=t.num,i=this.game.frameCount%e;this.interpolateX=i/e*this.x+(1-i/e)*this.prevx,this.interpolateY=i/e*this.y+(1-i/e)*this.prevy}else this.interpolateX=this.x,this.interpolateY=this.y;this.drawX=(this.interpolateX-e.x1)*e.zoom,this.drawY=(this.interpolateY-e.y1)*e.zoom}checkRectangle(t){const{x:e,y:i}=this;return e>t[0][0]&&e<t[1][0]&&i>t[0][1]&&i<t[1][1]}stop(){this.stopped=!0,this.vx=0,this.vy=0}move(){if(this.prevx=this.x,this.prevy=this.y,this.stopped)return;this.x+=this.vx,this.y+=this.vy,this.vx+=this.ax,this.vy+=this.ay,this.ax=0,this.ay=0,this.game.planets.forEach(t=>{const{dx:e,dy:i,dz2:s,dz:h,normal:a}=t.ballData();if(h<=this.radius+t.radius){let e=this.radius+t.radius-h;this.x+=e*a[0],this.y+=e*a[1],this.ax=0,this.ay=0,t.sticky||Math.abs(this.vx)+Math.abs(this.vy)<1?(this.stop(),this.game.currentPlanet=t,this.game.launchPad=new o(this.game,this.x,this.y,a,t.maxTheta),this.game.setupLaunchPad()):t.bounce(a)}else this.ax-=1/s*t.mass*e/h*.2,this.ay-=1/s*t.mass*i/h*.2});const t=this.game;t.obstacles.forEach(t=>{t.checkForBall()&&t.bounce()}),t.hole.checkForWin()&&this.winHandler()}winHandler(){this.stop();const t=this.game;t.currentLevelNumber>=t.levels.length-1?t.won=!0:(t.initiateLevel(),t.playSpeed={num:1,fractional:!1})}draw(t,e,i,s=this.radius){void 0===e&&(this.setAuxPositions(),e=this.drawX,i=this.drawY);let h=this.game.vp;t.beginPath(),t.fillStyle=this.color,t.beginPath(),t.arc(e,i,s*h.zoom,0,2*Math.PI,!0),t.fill()}};var c=class{constructor(t,e=0,i=0,s=10,h="grey",a,l=Math.PI/2,n=0,o=0){this.game=t,this.x=e,this.y=i,this.radius=s,this.color=h,this.draw=this.draw.bind(this),this.move=this.move.bind(this),this.vx=n,this.vy=o,this.density=a||1,this.mass=this.density*this.radius**3,this.sticky=!0,this.hideText=!1,this.maxTheta=l,this.textPos={x:e+s+2,y:i+s+.5}}vpX(){return this.game.vp.displayPos(this).x}vpY(){return this.game.vp.displayPos(this).y}move(){this.x+=this.vx,this.y+=this.vy}ballData(){const t=this.game.ball,e=t.x-this.x,i=t.y-this.y,s=e**2+i**2,h=Math.sqrt(s);return{dx:e,dy:i,dz2:s,dz:h,normal:[e/h,i/h]}}draw(t,e){let i=(this.x-e.x1)*e.zoom,s=(this.y-e.y1)*e.zoom,h=this.radius*e.zoom;t.fillStyle=this.color,t.beginPath(),t.arc(i,s,h,0,2*Math.PI,!0),t.font=`${Math.floor(.9*h)}px Arial`,t.fill(),this.hideText||(t.beginPath(),t.fillStyle="#3e78ad",t.font="14px Arial",t.fillText(`Escape vel. ${(this.radius*this.density**.45*.504).toFixed(2)}`,`${i+h+2}`,`${s+.5*h+this.game.ball.radius}`))}};var d=class{constructor(t,e=0,i=0,s=100,h=100,a="orange",l=1){this.game=t,this.x1=e,this.y1=i,this.x2=s,this.y2=h,this.color=a,this.draw=this.draw.bind(this),this.move=this.move.bind(this);let n=Math.sqrt((i-h)**2+(s-e)**2);this.normal=[(i-h)/n,(s-e)/n],this.bounce=this.bounce.bind(this),this.checkForBall=this.checkForBall.bind(this),this.width=l}bounce(){let t=this.game.ball,e=this.normal,i=t.vx*e[0]+t.vy*e[1],s=t.vx-2*i*e[0],h=t.vy-2*i*e[1];t.vx=s*(1-.02*Math.abs(i)),t.vy=h*(1-.02*Math.abs(i))}checkForBall(){let t=this.game.ball,{x1:e,x2:i,y1:s,y2:h}=this,a=[s-h,i-e],{x:n,y:o,radius:r,vx:c,vy:d}=t;return(a[0]*(n-e)+a[1]*(o-s))*(a[0]*(n+c-e)+a[1]*(o+d-s))<=0&&l([n,n+c],[e,i])&&l([o,o+d],[s,h])}move(){this.x+=this.vx,this.y+=this.vy}draw(t,e){let{x1:i,y1:s,zoom:h}=e;t.setLineDash([]),t.beginPath(),t.lineWidth=this.width,t.moveTo((this.x1-i)*h,(this.y1-s)*h),t.lineTo((this.x2-i)*h,(this.y2-s)*h),t.strokeStyle=this.color,t.stroke(),t.lineWidth=1}};var u=class{constructor(t,e=60,i,s="30px Arial",h=400,a=300){this.text=t,this.duration=e,this.font=s,this.x=h,this.y=a,this.color=i||"#3e78ad"}draw(t){t.beginPath(),t.fillStyle=this.color,t.font=this.font,t.fillText(this.text,this.x,this.y),t.fill()}};var m=class{constructor(t,e,i,s=[0,-1],h=100,a=1){this.game=t,this.x=e,this.y=i,this.width=h,this.drawFlag=this.drawFlag.bind(this),this.drawHole=this.drawHole.bind(this),this.normal=s,this.drawFlag=this.drawFlag.bind(this),this.drawHole=this.drawHole.bind(this)}vpX(){return this.game.vp.displayPos(this).x}vpY(){return this.game.vp.displayPos(this).y}move(){this.x+=this.vx,this.y+=this.vy}drawFlag(t,e){let i=(this.x-e.x1)*e.zoom,s=(this.y-e.y1)*e.zoom,h=this.normal,a=e.zoom;t.setLineDash([]),t.beginPath(),t.strokeStyle="gold",t.moveTo(i,s),t.lineTo(i+50*a*h[0],s+50*a*h[1]),t.stroke(),t.fillStyle="#db0711",t.moveTo(i+50*a*h[0],s+50*a*h[1]),t.lineTo(i+70*a*h[0],s+70*a*h[1]),t.lineTo(i+60*a*h[0]-30*a*h[1],s+60*a*h[1]+30*a*h[0]),t.lineTo(i+50*a*h[0],s+50*a*h[1]),t.fill()}drawHole(t,e){let i=(this.x-e.x1)*e.zoom,s=(this.y-e.y1)*e.zoom,{width:h,normal:a}=this,l=e.zoom;t.beginPath(),t.strokeStyle="purple",t.lineWidth=2,t.moveTo(i-l*a[1]*h/2,s+l*a[0]*h/2),t.lineTo(i+l*a[1]*h/2,s-l*a[0]*h/2),t.stroke(),t.beginPath(),t.lineWidth=1}drawHoleWithBound(t,e,i){let s=(this.x-e.x1)*e.zoom,h=(this.y-e.y1)*e.zoom,{width:a,normal:l}=this,n=e.zoom;t.beginPath(),t.strokeStyle="purple",t.lineWidth=2,t.moveTo(Math.max(i,s-n*l[1]*a/2),h+n*l[0]*a/2),t.lineTo(Math.max(i,s+n*l[1]*a/2),h-n*l[0]*a/2),t.stroke(),t.beginPath(),t.lineWidth=1}checkForWin(){let{x:t,y:e,width:i,normal:s}=this,h=this.game.ball,a=this.game.timedMessages,n=s[0]*(h.prevx-t)+s[1]*(h.prevy-e),o=s[0]*(h.x-t)+s[1]*(h.y-e);if(l([h.prevx,h.x],[t-.5*i*s[1],t+.5*i*s[1]])&&l([h.prevy,h.y],[e-.5*i*s[0],e+.5*i*s[0]])){if(n>=0&&o<=0){for(let t=0;t<a.length;t++)"WRONG WAY"===a[t].text&&(a[t]=new u("oh nice",14,"#9e8720","18px Arial",this.x+50,this.y+100));return!0}n<0&&o>0&&a.push(new u("WRONG WAY",80,"#9c1c22","28px Trebuchet MS",this.x,this.y+70))}return!1}};var y=class{constructor(t){this.ball=new r(t,330,240),this.corners=[[-2e3,-2e3],[4200,4e3]],this.currentPlanet=new c(t,300,240,25,"#27753a",1),this.launchPad=new o(t,this.ball.x,this.ball.y,[1,0]),this.planets=[this.currentPlanet],this.hole=new m(t,680,435,[0,-1],100),this.obstacles=[new d(t,350,280,750,500),new d(t,750,150,750,500)],this.viewportMovementStartX=700,this.viewportMovementStartY=500}};var v=class{constructor(t){this.ball=new r(t,600,300),this.currentPlanet=new c(t,600,330,25,"#27753a",1),this.corners=[[-200,-800],[2400,1900]],this.launchPad=new o(t,600,300,[0,-1]),this.planets=[this.currentPlanet],this.hole=new m(t,640,180),this.obstacles=[]}};var p=class{constructor(t){const e=1/Math.sqrt(2);this.ball=new r(t,100+30*e,40+30*e),this.corners=[[-200,-200],[3400,3100]],this.currentPlanet=new c(t,100,40,25,"#27753a",1),this.launchPad=new o(t,this.ball.x,this.ball.y,[e,e]),this.planets=[this.currentPlanet,new c(t,640,490,22,"orange",2)];let i=1/Math.sqrt(2);this.hole=new m(t,720,420,[i,-i],100),this.obstacles=[new d(t,250,150,640,340)]}};var x=class{constructor(t){const e=1/Math.sqrt(2);this.ball=new r(t,590,245),this.corners=[[-200,-200],[3400,3100]],this.currentPlanet=new c(t,560,245,25,"#27753a",1),this.launchPad=new o(t,this.ball.x,this.ball.y,[1,0]),this.planets=[this.currentPlanet,new c(t,640,280,20,"orange",1)],this.hole=new m(t,665,330,[e,-e],100),this.obstacles=[new d(t,250,280,640,280)],this.viewportMovementStartX=700,this.viewportMovementStartY=500}};var w=class{constructor(t){const e=1/Math.sqrt(2);this.ball=new r(t,200+40*e,380-40*e),this.corners=[[-500,-500],[3400,3100]],this.currentPlanet=new c(t,200,380,35,"#27753a",1,Math.PI/2),this.launchPad=new o(t,this.ball.x,this.ball.y,[e,-e],Math.PI/2),this.planets=[this.currentPlanet,new c(t,700,250,35,"orange",1.2),new c(t,440,200,30,"orange",1.2),new c(t,660,430,30,"orange",1.2)];let i=1/Math.sqrt(2);this.hole=new m(t,720,330,[i,-i],100),this.obstacles=[],this.viewportMovementStartX=700,this.viewportMovementStartY=500}};const b=function(t,e,i,s,h,a,l,n){let[o,r]=[s,s+a],c=[];for(;r<=h+.01;){const s=new d(t,e(o),i(o),e(r),i(r),l,n);o+=a,r+=a,c.push(s)}return c};var g=class{constructor(t){this.ball=new r(t,190,190),this.corners=[[-500,-500],[3400,3100]],this.currentPlanet=new c(t,150,190,35,"#27753a",1,Math.PI/2),this.launchPad=new o(t,this.ball.x,this.ball.y,[1,0],Math.PI/2),this.planets=[this.currentPlanet];let e=1/Math.sqrt(2);this.hole=new m(t,400,390,[e,-e],100);const i=b(t,t=>500+300*Math.sin(t),t=>290+120*Math.cos(t),-.78*Math.PI,-.4*Math.PI,Math.PI/100),s=b(t,t=>500+300*Math.sin(t),t=>290+120*Math.cos(t),-Math.PI/4+.5,Math.PI,Math.PI/100);this.obstacles=[].concat(i).concat(s),this.viewportMovementStartX=700,this.viewportMovementStartY=500}};var f=class{constructor(t){this.ball=new r(t,185,333),this.corners=[[-500,-500],[3400,3100]],this.currentPlanet=new c(t,185,350,12,"#27753a",1,Math.PI/2),this.launchPad=new o(t,this.ball.x,this.ball.y,[0,-1],Math.PI/2),this.planets=[this.currentPlanet,new c(t,650,380,20,"orange",1.2),new c(t,500,430,35,"orange",1.2)],Math.sqrt(2),this.hole=new m(t,535,360,[-1,0],100);const e=b(t,t=>530+26*t*Math.sin(t),t=>420+27*t*Math.cos(t),3.5,17,Math.PI/100);this.obstacles=[new d(t,530,590,530,725)],this.obstacles.push(...e),this.viewportZoom=.75,this.viewportX2=1500,this.viewportY2=750,this.viewportMovementStartX=700,this.viewportMovementStartY=1200}};var P=class{constructor(t){const e=1/Math.sqrt(2);this.ball=new r(t,350+17*e,120+17*e),this.corners=[[-500,-500],[3400,3100]],this.currentPlanet=new c(t,350,120,12,"#27753a",1,Math.PI/2),this.launchPad=new o(t,this.ball.x,this.ball.y,[e,e],Math.PI/2),this.planets=[this.currentPlanet,new c(t,820,300,45,"orange",3),new c(t,500,230,50,"orange",.3)];const i=b(t,t=>800+300*Math.sin(t),t=>300+120*Math.cos(t),-0,1.01*Math.PI,Math.PI/100);let s=new d(t,390,230,440,230);this.obstacles=[s].concat(i),Math.sqrt(2),this.hole=new m(t,1050,300,[-1,0],100),this.viewportMovementStartX=700,this.viewportMovementStartY=500}};var M=class{constructor(t){Math.sqrt(2),this.ball=new r(t,567,120),this.corners=[[-55500,-222500],[2225400,2225100]],this.currentPlanet=new c(t,550,120,12,"#27753a",1,Math.PI/2),this.launchPad=new o(t,this.ball.x,this.ball.y,[1,0],Math.PI/2),this.planets=[this.currentPlanet,new c(t,1120,1200,750,"orange",.005)];const e=b(t,t=>1120+t/3.96*1e3*Math.cos(t),t=>1200+t/3.96*1e3*Math.sin(t),3,3.96,Math.PI/60),i=b(t,t=>50+400*Math.cos(t),t=>400-250*Math.sin(t),-.43,Math.PI,Math.PI/60);this.obstacles=[].concat(e).concat(i),Math.sqrt(2),this.hole=new m(t,30,430,[0,-1],480)}};var k=class{constructor(t){this.splash=!0,Math.sqrt(2),this.ball=new r(t,812,190),this.ball.stopped=!1,this.ball.vx=-1.6,this.ball.vy=3,this.ball.winHandler=this.winHandler.bind(this.ball),this.viewportStyle="stopped",this.corners=[[-55500,-222500],[2225400,2225100]],this.currentPlanet=new c(t,-1e3,120,12,"black",1e-4,Math.PI/2),this.launchPad=new o(t,-1e3,this.ball.y,[0,1],Math.PI/2),this.planets=[this.currentPlanet];const e=b(t,t=>790+34*Math.cos(t),t=>155+48*Math.sin(t),.55,1.75*Math.PI,Math.PI/60,"orange",2);b(t,t=>910+45*Math.cos(t),t=>155+59*Math.sin(t),.5,1.8*Math.PI,Math.PI/60,"orange",25),this.obstacles=[].concat(e),this.hole=new m(t,850,222,[0,-1],100)}winHandler(){this.game.titleSequenceController.winHandler()}};var S=class{constructor(t){this.game=t,this.start=this.start.bind(this),this.textRGB=[75,45,0],this.phase=0,this.starRGB=[0,0,0],this.startGamePlay=this.startGamePlay.bind(this)}start(){this.game.initiateLevel(k),requestAnimationFrame(this.game.animate)}draw(t){if(console.log(`phase: ${this.phase}`),1===this.phase){let t=this.textRGB.slice();const e=Math.min(255,t[0]+2);this.textRGB=[e,Math.floor(165*e/255),0];let i=this.starRGB[0],s=Math.min(i+2,255);this.starRGB=[s,s,s]}t.fillStyle=`rgb(${this.textRGB[0]},${this.textRGB[1]},${this.textRGB[2]})`,t.font="bold 180px Arial",this.phase>=1&&(t.font="bold 180px Arial",t.fillText("SPACE",365,220)),t.fillText("GOLF",380,400),this.starRGB[0]>=255&&(1===this.phase&&(document.body.addEventListener("click",this.startGamePlay),this.phase=2),t.fillStyle="white",t.font="26px Arial",t.fillText("Click anywhere to start",450,500))}startGamePlay(){this.game.initiateLevel(),this.game.titleSequenceController=null,document.body.removeEventListener("click",this.startGamePlay)}drawStars(t){const e=this.starRGB,i=`rgb(${e[0]}, ${e[1]}, ${e[2]})`;this.game.stars.draw(t,i)}winHandler(){this.phase=1,this.game}};var T=class{constructor(t,e=0,i=0,s=1200+e,h=600+i,a=1){this.x1=t.viewportX1||e,this.y1=t.viewportY1||i,this.x2=t.viewportX2||s,this.y2=t.viewportY2||h,this.zoom=t.viewportZoom||a,this.setMovementStart=this.setMovementStartPoints.bind(this),this.moveWithBall=this.moveWithBall.bind(this),this.style=t.viewportStyle}setMovementStartPoints(t,e,i,s){this.startUp=t||0,this.startRight=e||1100,this.startDown=i||530,this.startLeft=s||0}moveWithBall(t,e,i){if("stopped"===this.style)return;let{x1:s,y1:h,zoom:a}=this;return(t>s+1200*a-100/a||t<s+100/a||e<h+50/a||e>h+600*a-50/a)&&(this.style="panning"),"panning"===this.style?this.panToBall(i):"centered"===this.style?this.moveCentered(t,e):void 0}moveCentered(t,e){this.x1=t-600/this.zoom,this.x2=t+600/this.zoom,this.y1=e-300/this.zoom,this.y2=e+300/this.zoom}panToBall(t){const e=t.interpolateX,i=t.interpolateY,s=t.prevInterpolateX,h=t.prevInterpolateY;let a=10*this.zoom,l=s-(this.x1+600/this.zoom),n=h-(this.y1+300/this.zoom),o=null,r=null;o=l<0?Math.min(l+a,0):Math.max(l-a,0),r=n<0?Math.min(n+a,0):Math.max(n-a,0),this.x1+=e-s+l-o,this.y1+=i-h+n-r,0===o&&0===r&&(this.style="centered")}displayPos(t){return{x:t.x-this.x1,y:t.y-this.y1}}},L=i(0),z=i.n(L);var I=class{constructor(t,e,i){this.topLeft={x:e.corners[0]-600,y:e.corners[0]-300},this.bottomRight={x:e.corners[1]+600,y:e.corners[1]+300},this.blocks={},this.starsPerBlock=300,this.levelNum=i,this.game=t}generateBlock(t,e){let i=t,s=e;const h=1e3*i+s+1e4*this.levelNum,a=z()(h),l=new Array(this.starsPerBlock);for(let t=0;t<l.length;t++)l[t]=[1e3*(i+a.nextFloat()),1e3*(s+a.nextFloat()),.08+.8*a.nextFloat()**2];this.blocks[`${i}, ${s}`]=l}drawBlock(t,e,i,s,h="white"){let a=this.blocks[`${e}, ${i}`];t.fillStyle=h;for(let e=0;e<a.length;e++){let[i,h,l]=a[e];l*s.zoom<.3||(t.beginPath(),t.arc((i-s.x1)*s.zoom,(h-s.y1)*s.zoom,l*s.zoom,0,2*Math.PI,!0),t.fill())}}getBlock(t,e){return this.blocks[`${t}, ${e}`]}draw(t,e){let i=this.game.vp,s=i.x1+1200*i.zoom,h=i.y1+600*i.zoom;for(let a=Math.floor(i.x1/1e3);a<=Math.ceil(s/1e3);a++)for(let s=Math.floor(i.y1/1e3);s<=Math.ceil(h/1e3);s++)this.getBlock(a,s)||this.generateBlock(a,s),this.drawBlock(t,a,s,i,e)}};const B=()=>{let t=document.getElementById("game-canvas").getBoundingClientRect();return{x:t.x,y:t.y}};var A=class{constructor(t,e,i,s="black"){this.game=t,this.clickHandler=this.clickHandler.bind(this),t.canvas.addEventListener("click",this.clickHandler),this.visible=!0,this.x=e,this.y=i,this.color=s}draw(t){this.visible&&(t.beginPath(),t.fillStyle=this.color,t.font="25px Arial",t.fillText("Start",this.x,this.y),t.fill(),t.beginPath(),t.strokeStyle=this.color,t.moveTo(this.x-20,this.y+10),t.lineTo(this.x-20,this.y-25),t.lineTo(this.x+75,this.y-25),t.lineTo(this.x+75,this.y+10),t.lineTo(this.x-20,this.y+10),t.stroke())}clickHandler(t){const e=t.clientX-B().x,i=t.clientY-B().y;e>=this.x-20&&e<=this.x+75&&i>=this.y-25&&i<=this.y+10&&(this.game.setupLaunchPad(),this.game.canvas.removeEventListener("click",this.clickHandler,!1),this.visible=!1,this.game.menu=null)}};var C=class{constructor(t){this.color="#e8e4da",this.game=t,this.startButton=new A(t,500,350)}draw(t,e=400,i=100){t.fillStyle=this.color,t.beginPath(),t.rect(e,i,e+200,i+250),t.stroke(),t.fill(),t.beginPath(),t.fillStyle="black",t.font="18px Arial",t.fillText("Use mouse or arrow keys to select launch direction. Click to launch.",e+30,i+40),t.fillText("Use 's' or 'f' for slower or faster playspeed, and 'p' to pause.",e+30,i+80),t.fillText("Pressing 'r' restarts the current level.",e+30,i+120),t.fillText("Press 'm' to return to this menu.",e+30,i+160),t.fill(),this.startButton.draw(t)}};var E=class{constructor(t,e,i,s){this.level=t,this.x=e,this.y=i,this.scale=s,this.vp={x1:-e/s,y1:-i/s,x2:e+1200*s,y2:i+600*s,zoom:s}}draw(t){const{obstacles:e,ball:i,planets:s,hole:h}=this.level;[i].concat(s).forEach(e=>{t.beginPath(),t.fillStyle=e.color,t.beginPath(),t.arc(this.scale*e.x+this.x,this.scale*e.y+this.y,this.scale*e.radius,0,2*Math.PI,!0),t.fill()}),t.setLineDash([]),e.forEach(e=>{e.y1<0||e.y2<0||e.x1<0||e.x2<0||(t.beginPath(),t.moveTo(this.scale*e.x1+this.x,this.scale*e.y1+this.y),t.lineTo(this.scale*e.x2+this.x,this.scale*e.y2+this.y),t.strokeStyle=e.color,t.stroke())}),h.drawFlag(t,this.vp),h.drawHoleWithBound(t,this.vp,this.x)}};const Y=()=>{let t=document.getElementById("game-canvas").getBoundingClientRect();return{x:t.x,y:t.y}};var V=class{constructor(t){this.game=t;const e=t.levels.slice(1),i=Math.ceil(Math.sqrt(e.length));this.perSide=i,this.draw=this.draw.bind(this),this.installEventListener=this.installEventListener.bind(this),this.removeEventListener=this.removeEventListener.bind(this),this.clickHandler=this.clickHandler.bind(this);const s=1/i;this.levelDisplays=e.map((e,h)=>new E(new e(t),h%i*1200/i,600*s*Math.floor(h/i),s))}installEventListener(){this.game.canvas.addEventListener("click",this.clickHandler)}clickHandler(t){const e=this.perSide,i=t.clientX-Y().x,s=t.clientY-Y().y,h=1+Math.floor(e*i/1200)+Math.floor(e*s/600)*e;this.game.currentLevelNumber=h-1,this.game.animating=!0,this.game.animate(),this.game.initiateLevel(),this.removeEventListener()}removeEventListener(){this.game.canvas.removeEventListener("click",this.clickHandler)}draw(t){t.strokeStyle="white";const e=this.perSide;for(let i=0;i<=e;i++)t.beginPath(),t.moveTo(0,600*i/e),t.lineTo(1200,600*i/e),t.stroke(),t.beginPath(),t.moveTo(1200*i/e,0),t.lineTo(1200*i/e,600),t.stroke();this.levelDisplays.forEach(e=>e.draw(t))}};var X=class{constructor(){this.canvas=document.getElementById("game-canvas"),this.canvas.setAttribute("tabindex",0),this.ctx=this.canvas.getContext("2d"),this.animating=!0,this.levels=[null,y,v,p,x,w,g,f,P,M],this.currentLevelNumber=0,this.draw=this.draw.bind(this),this.initiateLevel=this.initiateLevel.bind(this),this.setupLaunchPad=this.setupLaunchPad.bind(this),this.playSpeed={num:1,fractional:!1},this.setSpeedAndZoom=this.setSpeedAndZoom.bind(this),this.animate=this.animate.bind(this),this.frameCount=0,this.vp=new T({}),this.restartLevel=this.restartLevel.bind(this),this.levelControl=this.levelControl.bind(this),this.displayKeyCommands=this.displayKeyCommands.bind(this),this.switchToLevelMenu=this.switchToLevelMenu.bind(this),this.timedMessages=[],this.canvas.addEventListener("keydown",this.levelControl),window.printo=()=>{this.ball,console.log(`\n            vpx1: ${this.vp.x1},  vpy1: ${this.vp.y1}, zoom: ${this.vp.zoom}`)},this.menuReady(),this.titleSequenceController=new S(this)}start(){this.titleSequenceController.start()}levelControl(t){console.log(t.keyCode),82===t.keyCode&&this.restartLevel(),76===t.keyCode&&this.switchToLevelMenu()}switchToLevelMenu(){const t=new V(this),{ctx:e,canvas:i}=this;e.strokeStyle="black",e.fillStyle="black",this.animating=!1,e.clearRect(0,0,1200,600),t.draw(this.ctx),t.installEventListener()}initiateLevel(t){this.won=!1,t||(this.currentLevelNumber+=1,t=this.levels[this.currentLevelNumber]);const e=new t(this);this.level=e,this.vp=new T(e),this.ball=e.ball,this.currentPlanet=e.currentPlanet,this.launchPad=e.launchPad,this.planets=e.planets||[],this.hole=e.hole,this.obstacles=e.obstacles||[],this.corners=e.corners,this.stars=new I(this,e,this.currentLevelNumber),this.stars.generateBlock(0,0),this.vp.setMovementStartPoints(e.viewportMovementUp,e.viewportMovementRight,e.viewportMovementDown,e.viewportMovementLeft),this.canvas.addEventListener("keydown",this.setSpeedAndZoom,!1),this.menu||this.setupLaunchPad()}restartLevel(){this.currentLevelNumber-=1,this.initiateLevel()}zoomIn(){let t=this.vp,e=t.zoom,i=this.ball.interpolateX,s=this.ball.interpolateY;t.zoom>=2||(t.zoom=Math.min(t.zoom+.1,2),t.x1=i+(t.x1-i)*e/t.zoom,t.y1=s+(t.y1-s)*e/t.zoom,this.launchPad.setVelocity())}zoomOut(){let t=this.vp,e=t.zoom,i=this.ball.interpolateX,s=this.ball.interpolateY;t.zoom<=.5||(t.zoom=Math.max(t.zoom-.1,.5),t.x1=i+(t.x1-i)*e/t.zoom,t.y1=s+(t.y1-s)*e/t.zoom,this.launchPad.setVelocity())}setSpeedAndZoom(t){if([70,83,88,90].includes(t.keyCode)){if(90===t.keyCode)return this.zoomIn();if(88===t.keyCode)return this.zoomOut();70===t.keyCode&&(this.playSpeed.fractional?[2,3,4].includes(this.playSpeed.num)?this.playSpeed.num-=1:1===this.playSpeed.num&&(this.playSpeed.fractional=!1,this.playSpeed.num=2):[1,2,3].includes(this.playSpeed.num)&&(this.playSpeed.num+=1)),83===t.keyCode&&(this.playSpeed.fractional?[1,2,3].includes(this.playSpeed.num)&&(this.playSpeed.num+=1):[2,3,4].includes(this.playSpeed.num)?this.playSpeed.num-=1:1===this.playSpeed.num&&(this.playSpeed.fractional=!0,this.playSpeed.num=2)),this.timedMessages=[new u(`Playspeed: ${this.playSpeed.fractional?(1/this.playSpeed.num).toFixed(2):this.playSpeed.num}`)]}}victoryMessage(){const t=this.ctx;t.beginPath(),t.fillStyle="white",t.font="30px Arial",t.fillText("You win!",400,400),t.fill()}setupLaunchPad(){let t=this,e=t.canvas,i=t=>this.launchPad.setVelocity(t),s=t=>{this.launchPad.launch()&&(e.removeEventListener("mousemove",i,!1),e.removeEventListener("click",s,!1),e.removeEventListener("keydown",a,!1),this.launchPad=null)},h=[37,38,39,40],a=l=>{h.includes(l.keyCode)&&e.removeEventListener("mousemove",i,!1),t.launchPad.setVelocityByArrowKeys(l,()=>{e.removeEventListener("keydown",a,!1),e.removeEventListener("click",s,!1),this.launchPad=null})};this.setVelocityWithMouse=i,this.keyDownHandler=a,this.launchBallWithMouse=s,e.addEventListener("mousemove",this.setVelocityWithMouse,!1),e.addEventListener("keydown",this.keyDownHandler,!1),e.addEventListener("click",this.launchBallWithMouse,!1)}disableLaunchPad(){let t=this.canvas;t.removeEventListener("keydown",this.keyDownHandler,!1),t.removeEventListener("click",this.launchBallWithMouse,!1),t.removeEventListener("mousemove",this.setVelocityWithMouse,!1)}menuReady(){this.canvas.addEventListener("keydown",t=>{77===t.keyCode&&(this.disableLaunchPad(),this.menu=new C(this)),80===t.keyCode&&(this.animating?this.animating=!1:(this.animating=!0,requestAnimationFrame(this.animate.bind(this))))},!1)}step(t){this.moveObjects(t),this.vp.moveWithBall(this.ball.interpolateX,this.ball.interpolateY,this.ball),this.timedMessages.forEach(t=>{t.duration-=1}),this.timedMessages=this.timedMessages.filter(t=>t.duration>=0)}moveObjects(){let{playSpeed:t}=this;if(t.fractional){if(this.frameCount%t.num==0&&(this.ball.move(),!this.ball.checkRectangle(this.corners)))return void this.restartLevel()}else for(let e=1;e<=t.num;e++)if(this.ball.move(),!this.ball.checkRectangle(this.corners))return void this.restartLevel()}animate(t){const e=t-this.lastTime;this.step(e),this.animating&&(this.draw(),this.lastTime=t,this.frameCount+=1,requestAnimationFrame(this.animate.bind(this)))}displayKeyCommands(){let t=this.ctx;t.beginPath(),t.fillStyle="white",t.font="15px Arial",t.fillText("r to restart",1090,510),t.fill(),t.beginPath(),t.fillText("p to pause",1090,525),t.fill(),t.beginPath(),t.fillText("l to select level",1090,540),t.fill(),t.beginPath(),t.fillText("s/f: slow/fast",1090,555),t.fill(),t.beginPath(),t.fillText("z/x: zoom in/out",1090,570),t.fill()}draw(){let{ctx:t,ball:e,vp:i,launchPad:s,hole:h}=this;t.fillStyle="black",t.strokeStyle="black",t.clearRect(0,0,1200,600),this.displayKeyCommands(),this.stars&&(this.titleSequenceController?this.titleSequenceController.drawStars(t):this.stars.draw(t)),h.drawFlag(t,i),h.drawHole(t,i),this.obstacles.forEach(e=>e.draw(t,i)),e.draw(t),this.planets.forEach(e=>e.draw(t,i)),this.timedMessages.forEach(e=>{e.draw(t)}),s&&s.draw(t,i),this.won&&this.victoryMessage(),this.titleSequenceController||(t.fillStyle="#3e78ad",t.font="14px Arial",t.fillText(`Velocity_x=${this.ball.vx.toFixed(0)}, Velocity_y=${this.ball.vy.toFixed(0)},\n        speed = ${Math.sqrt(this.ball.vx**2+this.ball.vy**2).toFixed(0)}`,20,550),t.font="16px Arial",t.fillStyle="white",t.fillText(`Level ${this.currentLevelNumber}`,20,580)),this.menu&&this.menu.draw(t),this.titleSequenceController&&this.titleSequenceController.draw(t)}};document.addEventListener("DOMContentLoaded",t=>{(new X).start()})}]);
//# sourceMappingURL=main.js.map